import{c as p,g as S,l as O,j as e,G as q,H as k,m as A,F as I,b as R,r as n,J as Q,n as C,K as D,a as $,O as K}from"./index-Mbs-38nN.js";import{p as T}from"./apiOrder-Dmmv97Wz.js";function B({item:r}){const o=p(S(r.id)),l=O();return console.log(r),e.jsx("li",{onClick:()=>l(`../item/${r.name+r.description+r.id}`),children:e.jsxs("div",{className:"text mb-2 flex items-center justify-between border-b-2 pb-1 text-blue-gray-800 hover:cursor-pointer hover:text-red-900 sm:text-lg",children:[e.jsx("p",{className:"font-semibold",children:r.name}),e.jsxs("p",{children:["x",o]})]})})}function G(r,o,l){const x=p(q),c=p(k),j=p(A),h=I(),v=O(),a=R(),[u,i]=n.useState({fullname:"",address:"",phone:""}),{mutate:y,status:N,error:f}=Q({mutationFn:T,onSuccess:()=>{h.invalidateQueries({queryKey:["orders"]}),C.success("Your order has been placed successfully"),a(D()),v("/orders")},onError:s=>{C.error(s.message),console.error("Order placement error:",s)}});f&&C.error("ERROR: ",f);const b=n.useCallback(s=>s?s.length<5?"Full name must be at least 5 characters long.":"":"Full name is required.",[]),t=n.useCallback(s=>s?s.length<10?"Address must be at least 10 characters long.":"":"Address is required.",[]),E=n.useCallback(s=>{const d=/^[0-9]{9,15}$/;return s?d.test(s)?"":"Enter a valid phone number (10-15 digits).":"Phone number is required."},[]),F=n.useCallback((s,d,g)=>{const m=s.target.value;g(m),i(w=>({...w,[s.target.name]:d(m)}))},[]);function P(s){s.preventDefault();const d=b(r),g=t(o),m=E(l);if(d||g||m){i({fullname:d,address:g,phone:m});return}const w={userId:j.userid,fullname:r,address:o,phone:l,items:x,totalPrice:c};y(w),console.log("Form submitted:",{fullname:r,address:o,phone:l})}return{items:x,totalPrice:c,errors:u,handleInputChange:F,handleSubmit:P,validateAddress:t,validateFullname:b,validatePhone:E,status:N}}function L(){const[r,o]=n.useState(""),[l,x]=n.useState(""),[c,j]=n.useState(""),{items:h,totalPrice:v,errors:a,handleInputChange:u,handleSubmit:i,validateAddress:y,validateFullname:N,validatePhone:f,status:b}=G(r,l,c);return e.jsxs(e.Fragment,{children:[b==="pending"&&e.jsx($,{}),e.jsx("div",{className:"flex h-full w-full items-start justify-center",children:e.jsxs("form",{className:"flex flex-col justify-center pt-36",onSubmit:i,children:[e.jsx("p",{className:"mb-8 rounded-t-lg border-b-2 border-red-500 py-3 text-center text-2xl font-bold hover:cursor-default sm:mb-14",children:"Placing Order"}),e.jsxs("div",{className:"mb-5 flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between sm:gap-8 sm:text-lg",children:[e.jsx("label",{className:"font-bold text-gray-700",children:"Full Name:"}),e.jsxs("div",{children:[e.jsx("input",{className:"h-9 w-72 rounded-full border-2 border-gray-400 px-5 text-base hover:border-red-200 focus:border-none focus:bg-red-50/25 focus:outline-red-200 sm:h-10 sm:w-72",type:"text",name:"fullname",value:r,placeholder:"Enter your full name",onChange:t=>u(t,N,o),required:!0}),a.fullname&&e.jsx("p",{className:"text-right text-sm text-red-500",children:a.fullname})]})]}),e.jsxs("div",{className:"mb-5 flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between sm:gap-8 sm:text-lg",children:[e.jsx("label",{className:"font-bold text-gray-700",children:"Address:"}),e.jsxs("div",{children:[e.jsx("input",{className:"h-9 w-72 rounded-full border-2 border-gray-400 px-5 text-base hover:border-red-200 focus:border-none focus:bg-red-50/25 focus:outline-red-200 sm:h-10 sm:w-72",type:"text",name:"address",placeholder:"Enter your correct address",value:l,onChange:t=>u(t,y,x),required:!0}),a.address&&e.jsx("p",{className:"text-right text-sm text-red-500",children:a.address})]})]}),e.jsxs("div",{className:"mb-5 flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between sm:gap-8 sm:text-lg",children:[e.jsx("label",{className:"font-bold text-gray-700",children:"Phone Number:"}),e.jsxs("div",{children:[e.jsx("input",{className:"h-9 w-72 rounded-full border-2 border-gray-400 px-5 text-base hover:border-red-200 focus:border-none focus:bg-red-50/25 focus:outline-red-200 sm:h-10 sm:w-72",type:"tel",name:"phone",placeholder:"Enter your phone number",value:c,onChange:t=>u(t,f,j),required:!0}),a.phone&&e.jsx("p",{className:"text-right text-sm text-red-500",children:a.phone})]})]}),e.jsxs("div",{className:"my-5 flex flex-col",children:[e.jsx("label",{className:"mb-2 text-left text-lg font-bold text-red-400 sm:mb-5 sm:text-xl",children:"Cart Details"}),e.jsx("ul",{className:"mb-4",children:h&&h.map(t=>e.jsx(B,{item:t},t.id))}),e.jsxs("div",{className:"mb-4 flex items-center justify-between hover:cursor-default",children:[e.jsx("label",{className:"text-left text-lg font-bold text-gray-800 sm:text-xl",children:"Total Price:"}),e.jsxs("p",{className:"text-lg font-semibold text-green-500 sm:text-xl",children:["$",v]})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(K,{text:"Submit Order",onClick:i})})]})]})})]})}export{L as default};
